{"version":3,"file":"commands.js","mappings":"YAYA,IAAIA,EAXJ,SAAgBC,GAIZ,IAHA,IAAIC,EAAmB,GACnBC,EAAmB,aACnBC,EAAmBD,EAAWF,OACxBI,EAAI,EAAGA,EAOG,GAPSA,IAC3BH,GAAUC,EAAWG,OAAOC,KAAKC,MAAMD,KAAKE,SACjDL,IAEE,OAAOF,EAGOQ,GAcbC,EAXJ,SAAkBV,GAId,IAHA,IAAIC,EAAmB,GACnBC,EAAmB,4BACnBC,EAAmBD,EAAWF,OACxBI,EAAI,EAAGA,EAOO,GAPKA,IAC3BH,GAAUC,EAAWG,OAAOC,KAAKC,MAAMD,KAAKE,SACjDL,IAEE,OAAOF,EAGSU,GAKfC,EAAEC,KAAK,CACHC,KAAM,OACNC,IAJY,+CAKZC,YAAa,kCACbC,SAAU,OACVC,KAAMC,KAAKC,UAAW,CAAE,WAAcrB,EAAY,aAAgBW,IAClEW,QAAU,SAASH,KAGpBI,MAAO,SAAUC,EAAIC,EAAYC,OAOxC,IAiBIC,EAjBEC,EAAU,2JAI0B5B,EAAa,QAAWW,EAJlD,gIAQSX,EART,6BAUWW,EAVX,sEAYoDX,EAZpD,6KAqBhB6B,OAAOC,SAAQ,WACPH,EAAcE,OAAOE,QAAQC,QAAQC,QAqB7CJ,OAAOK,QAAQC,UAAU,yBAfzB,SAA+BC,GAE3BT,EAAYU,KAAKC,SAAS,OACtB,CAAEC,aAAcH,IAChB,SAAUI,GACFA,EAAcC,SAAWZ,OAAOa,kBAAkBC,UAclE,SAAoBP,EAAOQ,GAEvBjB,EAAYU,KAAKQ,SAASD,EAAehB,EACrC,CAAEW,aAAcH,EAAOU,aAAc,SACrC,SAAUC,GACFA,EAAcN,SAAWZ,OAAOa,kBAAkBC,UAClDI,EAAcR,aAAaS,UAAU,CAAEC,YAAY,KAEnDC,QAAQ3B,MAAM,4BACdwB,EAAcR,aAAaS,UAAU,CAAEC,YAAY,QAtBnDE,CAAWX,EAAcD,aAAcC,EAAcY,QAErDF,QAAQ3B,MAAM,4BACdiB,EAAcD,aAAaS,UAAU,CAAEC,YAAY,W","sources":["webpack:///./src/commands/commands.js?"],"sourcesContent":["//create meeting id\nfunction makeid(length) {\n    var result           = '';\n    var characters       = '0123456789';\n    var charactersLength = characters.length;\n    for ( var i = 0; i < length; i++ ) {\n      result += characters.charAt(Math.floor(Math.random() * \n charactersLength));\n   }\n   return result;\n};\n\nvar meeting_id = makeid(12);\n\n//create meeting pass\nfunction makepass(length) {\n    var result           = '';\n    var characters       = 'abcdefghijklmnoprstuvwxyz';\n    var charactersLength = characters.length;\n    for ( var i = 0; i < length; i++ ) {\n      result += characters.charAt(Math.floor(Math.random() * \n charactersLength));\n   }\n   return result;\n};\n\nlet meeting_pass = makepass(15);\n\n//create meeting folder\n    var mkdir_req = \"https://eldercare.unknownland.org/file_mkdir\"; //$.URLEncode(name);\n\n    $.ajax({\n        type: 'POST',\n        url: mkdir_req,\n        contentType: \"application/json; charset=utf-8\",\n        dataType: \"json\",\n        data: JSON.stringify( { \"meeting_id\": meeting_id, \"meeting_pass\": meeting_pass} ),\n        success : function(data) {\n          //Success block  \n        },\n       error: function (xhr,ajaxOptions,throwError){\n        //Error block \n      },\n    });\n\n\n//Write to body\nconst newBody = '<br>' + '<hr>' + '<br>' +\n    '<h2>Ceremeet toplantı daveti</h2>' +\n    '<strong>Ceremeet uygulaması üzerinden toplantıya katılın.</strong>' +\n    '<br><br>' +\n    '<a href=\"ceremeet://ceremeet.com/' + meeting_id + '?pwd=' +  meeting_pass + '\" target=\"_blank\">Ceremeet Giriş</a>' +\n    '<br><br>' +\n    '<strong>veya toplantı bilgileri ile giriş yapın:</strong>' +\n    '<br><br>' +\n    'Toplantı Odası: ' + meeting_id +\n    '<br><br>' +\n    'Toplantı Şifresı: ' + meeting_pass +\n    '<br><br>' +\n    '<a href=\"https://nextcloud.unknownland.org/s/ceremeet?path=' + meeting_id + '\" target=\"_blank\">Sunum Ekle</a>' +\n    '<br><br>' +\n    '<a href=\"https://nextcloud.unknownland.org/s/aK9Q8Ed4D3Mwd5Z/download\"' + '\" target=\"_blank\">Ceremeet Uygulamasını İndirin.</a>' +\n    '<br><br>';\n    \nlet mailboxItem;\n\n\n// Office is ready.\nOffice.onReady(function () {\n        mailboxItem = Office.context.mailbox.item;\n    }\n);\n\n// 2. How to define and register a function command named `insertCeremeetMeeting` (referenced in the manifest)\n//    to update the meeting body with the online meeting details.\nfunction insertCeremeetMeeting(event) {\n    // Get HTML body from the client.\n    mailboxItem.body.getAsync(\"html\",\n        { asyncContext: event },\n        function (getBodyResult) {\n            if (getBodyResult.status === Office.AsyncResultStatus.Succeeded) {\n                updateBody(getBodyResult.asyncContext, getBodyResult.value);\n            } else {\n                console.error(\"Failed to get HTML body.\");\n                getBodyResult.asyncContext.completed({ allowEvent: false });\n            }\n        }\n    );\n}\n// Register the function.\nOffice.actions.associate(\"insertCeremeetMeeting\", insertCeremeetMeeting);\n\n// 3. How to implement a supporting function `updateBody`\n//    that appends the online meeting details to the current body of the meeting.\nfunction updateBody(event, existingBody) {\n    // Append new body to the existing body.\n    mailboxItem.body.setAsync(existingBody + newBody,\n        { asyncContext: event, coercionType: \"html\" },\n        function (setBodyResult) {\n            if (setBodyResult.status === Office.AsyncResultStatus.Succeeded) {\n                setBodyResult.asyncContext.completed({ allowEvent: true });\n            } else {\n                console.error(\"Failed to set HTML body.\");\n                setBodyResult.asyncContext.completed({ allowEvent: false });\n            }\n        }\n    );\n}"],"names":["meeting_id","length","result","characters","charactersLength","i","charAt","Math","floor","random","makeid","meeting_pass","makepass","$","ajax","type","url","contentType","dataType","data","JSON","stringify","success","error","xhr","ajaxOptions","throwError","mailboxItem","newBody","Office","onReady","context","mailbox","item","actions","associate","event","body","getAsync","asyncContext","getBodyResult","status","AsyncResultStatus","Succeeded","existingBody","setAsync","coercionType","setBodyResult","completed","allowEvent","console","updateBody","value"],"sourceRoot":""}