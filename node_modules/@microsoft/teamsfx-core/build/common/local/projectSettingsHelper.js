// Copyright (c) Microsoft Corporation.
// Licensed under the MIT license.
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ProjectSettingsHelper = void 0;
const question_1 = require("../../plugins/solution/fx-solution/question");
const tools_1 = require("../tools");
const constants_1 = require("../constants");
const constants_2 = require("./constants");
class ProjectSettingsHelper {
    static includeFrontend(projectSettings) {
        const solutionSettings = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.solutionSettings;
        const cap = (solutionSettings === null || solutionSettings === void 0 ? void 0 : solutionSettings.capabilities) || [];
        return (solutionSettings === null || solutionSettings === void 0 ? void 0 : solutionSettings.hostType) === question_1.HostTypeOptionAzure.id && cap.includes(question_1.TabOptionItem.id);
    }
    static includeBackend(projectSettings) {
        const solutionSettings = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.solutionSettings;
        const azureResources = (solutionSettings === null || solutionSettings === void 0 ? void 0 : solutionSettings.azureResources) || [];
        return ((solutionSettings === null || solutionSettings === void 0 ? void 0 : solutionSettings.hostType) === question_1.HostTypeOptionAzure.id &&
            azureResources.includes(question_1.AzureResourceFunction.id));
    }
    static includeFuncHostedBot(projectSettings) {
        var _a, _b, _c;
        const botHostType = (_b = (_a = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.pluginSettings) === null || _a === void 0 ? void 0 : _a[constants_1.ResourcePlugins.Bot]) === null || _b === void 0 ? void 0 : _b[constants_2.BotHostTypeName];
        const cap = ((_c = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.solutionSettings) === null || _c === void 0 ? void 0 : _c.capabilities) || [];
        return cap.includes(question_1.BotOptionItem.id) && botHostType === constants_2.BotHostTypes.AzureFunctions;
    }
    static includeBot(projectSettings) {
        var _a;
        const cap = ((_a = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.solutionSettings) === null || _a === void 0 ? void 0 : _a.capabilities) || [];
        return cap.includes(question_1.BotOptionItem.id) || cap.includes(question_1.MessageExtensionItem.id);
    }
    static getBotCapabilities(projectSettings) {
        var _a, _b;
        return (((_b = (_a = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.pluginSettings) === null || _a === void 0 ? void 0 : _a[constants_1.ResourcePlugins.Bot]) === null || _b === void 0 ? void 0 : _b[constants_2.BotCapabilities]) ||
            []);
    }
}
exports.ProjectSettingsHelper = ProjectSettingsHelper;
// keep the same logic as plugin.activate()
ProjectSettingsHelper.isSpfx = (projectSettings) => {
    var _a;
    return ((_a = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.solutionSettings) === null || _a === void 0 ? void 0 : _a.hostType) ===
        question_1.HostTypeOptionSPFx.id;
};
ProjectSettingsHelper.includeAAD = (projectSettings) => !!tools_1.isAADEnabled(projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.solutionSettings);
ProjectSettingsHelper.includeSimpleAuth = (projectSettings) => 
// TODO: update this when retiring simple auth service
!!tools_1.IsSimpleAuthEnabled(projectSettings);
//# sourceMappingURL=projectSettingsHelper.js.map