import { FxError, Result, PluginContext, TeamsAppManifest } from "@microsoft/teamsfx-api";
import { IUserList } from "./interfaces/IAppDefinition";
import { ResourcePermission, TeamsAppAdmin } from "../../../common/permissionInterface";
export declare class AppStudioPluginImpl {
    commonProperties: {
        [key: string]: string;
    };
    constructor();
    getAppDefinitionAndUpdate(ctx: PluginContext, isLocalDebug: boolean, manifest: TeamsAppManifest): Promise<Result<string, FxError>>;
    private getSPFxLocalDebugAppDefinitionAndUpdate;
    provision(ctx: PluginContext): Promise<Result<string, FxError>>;
    postProvision(ctx: PluginContext): Promise<Result<string, FxError>>;
    validateManifest(ctx: PluginContext, isLocalDebug: boolean): Promise<Result<string[], FxError>>;
    deploy(ctx: PluginContext): Promise<Result<any, FxError>>;
    updateManifest(ctx: PluginContext, isLocalDebug: boolean): Promise<Result<string, FxError>>;
    scaffold(ctx: PluginContext): Promise<any>;
    buildTeamsAppPackage(ctx: PluginContext, isLocalDebug: boolean): Promise<string>;
    publish(ctx: PluginContext): Promise<{
        name: string;
        id: string;
        update: boolean;
    }>;
    postLocalDebug(ctx: PluginContext): Promise<Result<string, FxError>>;
    checkPermission(ctx: PluginContext, userInfo: IUserList): Promise<ResourcePermission[]>;
    listCollaborator(ctx: PluginContext): Promise<TeamsAppAdmin[]>;
    grantPermission(ctx: PluginContext, userInfo: IUserList): Promise<ResourcePermission[]>;
    private beforePublish;
    private getConfigForCreatingManifest;
    private getTabEndpoint;
    private getTabDomain;
    private getTabIndexPath;
    private getAadClientId;
    private getBotId;
    private getBotDomain;
    private getApplicationIdUris;
    private getTeamsAppId;
    /**
     *
     * Refer to AppDefinitionProfile.cs
     */
    private convertToAppDefinition;
    private createApp;
    private updateApp;
    private validateManifestAgainstSchema;
    private getAppDefinitionAndManifest;
    private getSPFxManifest;
}
export declare function createLocalManifest(appName: string, hasFrontend: boolean, hasBot: boolean, hasMessageExtension: boolean, isSPFx: boolean, hasAad?: boolean, isM365?: boolean): Promise<TeamsAppManifest>;
export declare function createManifest(appName: string, hasFrontend: boolean, hasBot: boolean, hasNotificationBot: boolean, hasCommandAndResponseBot: boolean, hasMessageExtension: boolean, isSPFx: boolean, hasAad?: boolean, isM365?: boolean): Promise<TeamsAppManifest | undefined>;
//# sourceMappingURL=plugin.d.ts.map